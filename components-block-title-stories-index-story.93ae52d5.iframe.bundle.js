"use strict";(self.webpackChunkgutenberg=self.webpackChunkgutenberg||[]).push([[2753],{"./packages/block-editor/src/components/block-title/stories/index.story.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,default:()=>index_story});var build_module=__webpack_require__("./packages/block-library/build-module/index.js"),blocks_build_module=__webpack_require__("./packages/blocks/build-module/index.js"),provider=__webpack_require__("./packages/block-editor/src/components/provider/index.js"),use_select=__webpack_require__("./packages/data/build-module/components/use-select/index.js"),store=__webpack_require__("./packages/block-editor/src/store/index.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");(0,build_module.JK)();const blocks=[(0,blocks_build_module.Wv)("core/paragraph")],index_story={title:"BlockEditor/BlockTitle",component:function BlockTitle({clientId,maximumLength,context}){return function useBlockDisplayTitle({clientId,maximumLength,context}){const blockTitle=(0,use_select.A)((select=>{if(!clientId)return null;const{getBlockName,getBlockAttributes}=select(store.M),{getBlockType,getActiveBlockVariation}=select(blocks_build_module.M_),blockName=getBlockName(clientId),blockType=getBlockType(blockName);if(!blockType)return null;const attributes=getBlockAttributes(clientId),label=(0,blocks_build_module.Y0)(blockType,attributes,context);if(label!==blockType.title)return label;const match=getActiveBlockVariation(blockName,attributes);return match?.title||blockType.title}),[clientId,context]);if(!blockTitle)return null;if(maximumLength&&maximumLength>0&&blockTitle.length>maximumLength){const omission="...";return blockTitle.slice(0,maximumLength-omission.length)+omission}return blockTitle}({clientId,maximumLength,context})},parameters:{sourceLink:"packages/block-editor/src/components/block-title",badges:[],docs:{canvas:{sourceState:"shown"},description:{component:"Renders the block's configured title as a string, or empty if the title cannot be determined."}}},decorators:[Story=>(0,jsx_runtime.jsx)(provider.Cg,{value:blocks,children:(0,jsx_runtime.jsx)(Story,{})})],argTypes:{clientId:{control:{type:null},description:"Client ID of block.",table:{type:{summary:"string"}}},maximumLength:{control:{type:"number"},description:"The maximum length that the block title string may be before truncated.",table:{type:{summary:"number"}}},context:{control:{type:"text"},description:"The context to pass to `getBlockLabel`.",table:{type:{summary:"string"}}}}},Default={args:{clientId:blocks[0].clientId}};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {\n    clientId: blocks[0].clientId\n  }\n}",...Default.parameters?.docs?.source}}}},"./packages/block-editor/src/components/provider/block-refs-provider.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>BlockRefs,z:()=>BlockRefsProvider});var _wordpress_element__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_wordpress_compose__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/compose/build-module/utils/observable-map/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const BlockRefs=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_1__.createContext)({refsMap:(0,_wordpress_compose__WEBPACK_IMPORTED_MODULE_2__.u)()});function BlockRefsProvider({children}){const value=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>({refsMap:(0,_wordpress_compose__WEBPACK_IMPORTED_MODULE_2__.u)()})),[]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(BlockRefs.Provider,{value,children})}BlockRefsProvider.__docgenInfo={description:"",methods:[],displayName:"BlockRefsProvider"}},"./packages/block-editor/src/components/provider/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Cg:()=>ExperimentalBlockEditorProvider});var use_dispatch=__webpack_require__("./packages/data/build-module/components/use-dispatch/use-dispatch.js"),react=__webpack_require__("./node_modules/react/index.js"),slot_fill=__webpack_require__("./packages/components/build-module/slot-fill/index.js"),store=__webpack_require__("./packages/upload-media/build-module/store/index.js"),provider=__webpack_require__("./packages/upload-media/build-module/components/provider/index.js"),build_module_registry=__webpack_require__("./packages/data/build-module/registry.js"),use_registry=__webpack_require__("./packages/data/build-module/components/registry-provider/use-registry.js"),context=__webpack_require__("./packages/data/build-module/components/registry-provider/context.js"),create_higher_order_component=__webpack_require__("./packages/compose/build-module/utils/create-higher-order-component/index.js"),src_store=__webpack_require__("./packages/block-editor/src/store/index.js"),constants=__webpack_require__("./packages/block-editor/src/store/constants.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const with_registry_provider=(0,create_higher_order_component.f)((WrappedComponent=>({useSubRegistry=!0,...props})=>{const registry=(0,use_registry.A)(),[subRegistries]=(0,react.useState)((()=>new WeakMap)),subRegistry=function getSubRegistry(subRegistries,registry,useSubRegistry){if(!useSubRegistry)return registry;let subRegistry=subRegistries.get(registry);return subRegistry||(subRegistry=(0,build_module_registry.I)({},registry),subRegistry.registerStore(constants.E,src_store.i),subRegistries.set(registry,subRegistry)),subRegistry}(subRegistries,registry,useSubRegistry);return subRegistry===registry?(0,jsx_runtime.jsx)(WrappedComponent,{registry,...props}):(0,jsx_runtime.jsx)(context.Ay,{value:subRegistry,children:(0,jsx_runtime.jsx)(WrappedComponent,{registry:subRegistry,...props})})}),"withRegistryProvider");var use_block_sync=__webpack_require__("./packages/block-editor/src/components/provider/use-block-sync.js"),block_refs_provider=__webpack_require__("./packages/block-editor/src/components/provider/block-refs-provider.js"),lock_unlock=__webpack_require__("./packages/block-editor/src/lock-unlock.ts"),build_module=__webpack_require__("./packages/keyboard-shortcuts/build-module/index.js"),i18n_build_module=__webpack_require__("./packages/i18n/build-module/index.js");function KeyboardShortcuts(){return null}KeyboardShortcuts.Register=function KeyboardShortcutsRegister(){const{registerShortcut}=(0,use_dispatch.A)(build_module.M_);return(0,react.useEffect)((()=>{registerShortcut({name:"core/block-editor/copy",category:"block",description:(0,i18n_build_module.__)("Copy the selected block(s)."),keyCombination:{modifier:"primary",character:"c"}}),registerShortcut({name:"core/block-editor/cut",category:"block",description:(0,i18n_build_module.__)("Cut the selected block(s)."),keyCombination:{modifier:"primary",character:"x"}}),registerShortcut({name:"core/block-editor/paste",category:"block",description:(0,i18n_build_module.__)("Paste the selected block(s)."),keyCombination:{modifier:"primary",character:"v"}}),registerShortcut({name:"core/block-editor/duplicate",category:"block",description:(0,i18n_build_module.__)("Duplicate the selected block(s)."),keyCombination:{modifier:"primaryShift",character:"d"}}),registerShortcut({name:"core/block-editor/remove",category:"block",description:(0,i18n_build_module.__)("Remove the selected block(s)."),keyCombination:{modifier:"primaryShift",character:"backspace"}}),registerShortcut({name:"core/block-editor/insert-before",category:"block",description:(0,i18n_build_module.__)("Insert a new block before the selected block(s)."),keyCombination:{modifier:"primaryAlt",character:"t"}}),registerShortcut({name:"core/block-editor/insert-after",category:"block",description:(0,i18n_build_module.__)("Insert a new block after the selected block(s)."),keyCombination:{modifier:"primaryAlt",character:"y"}}),registerShortcut({name:"core/block-editor/delete-multi-selection",category:"block",description:(0,i18n_build_module.__)("Delete selection."),keyCombination:{character:"del"},aliases:[{character:"backspace"}]}),registerShortcut({name:"core/block-editor/select-all",category:"selection",description:(0,i18n_build_module.__)("Select all text when typing. Press again to select all blocks."),keyCombination:{modifier:"primary",character:"a"}}),registerShortcut({name:"core/block-editor/unselect",category:"selection",description:(0,i18n_build_module.__)("Clear selection."),keyCombination:{character:"escape"}}),registerShortcut({name:"core/block-editor/multi-text-selection",category:"selection",description:(0,i18n_build_module.__)("Select text across multiple blocks."),keyCombination:{modifier:"shift",character:"arrow"}}),registerShortcut({name:"core/block-editor/focus-toolbar",category:"global",description:(0,i18n_build_module.__)("Navigate to the nearest toolbar."),keyCombination:{modifier:"alt",character:"F10"}}),registerShortcut({name:"core/block-editor/move-up",category:"block",description:(0,i18n_build_module.__)("Move the selected block(s) up."),keyCombination:{modifier:"secondary",character:"t"}}),registerShortcut({name:"core/block-editor/move-down",category:"block",description:(0,i18n_build_module.__)("Move the selected block(s) down."),keyCombination:{modifier:"secondary",character:"y"}}),registerShortcut({name:"core/block-editor/collapse-list-view",category:"list-view",description:(0,i18n_build_module.__)("Collapse all other items."),keyCombination:{modifier:"alt",character:"l"}}),registerShortcut({name:"core/block-editor/group",category:"block",description:(0,i18n_build_module.__)("Create a group block from the selected multiple blocks."),keyCombination:{modifier:"primary",character:"g"}})}),[registerShortcut]),null};const keyboard_shortcuts=KeyboardShortcuts;const use_media_upload_settings=function useMediaUploadSettings(settings={}){return(0,react.useMemo)((()=>({mediaUpload:settings.mediaUpload,mediaSideload:settings.mediaSideload,maxUploadFileSize:settings.maxUploadFileSize,allowedMimeTypes:settings.allowedMimeTypes})),[settings])},noop=()=>{};function mediaUpload(registry,{allowedTypes,additionalData={},filesList,onError=noop,onFileChange,onSuccess,onBatchSuccess}){registry.dispatch(store.M).addItems({files:filesList,onChange:onFileChange,onSuccess,onBatchSuccess,onError:({message})=>onError(message),additionalData,allowedTypes})}const ExperimentalBlockEditorProvider=with_registry_provider((props=>{const{settings:_settings,registry,stripExperimentalSettings=!1}=props,mediaUploadSettings=use_media_upload_settings(_settings);let settings=_settings;window.__experimentalMediaProcessing&&_settings.mediaUpload&&(settings=(0,react.useMemo)((()=>({..._settings,mediaUpload:mediaUpload.bind(null,registry)})),[_settings,registry]));const{__experimentalUpdateSettings}=(0,lock_unlock.T)((0,use_dispatch.A)(src_store.M));(0,react.useEffect)((()=>{__experimentalUpdateSettings({...settings,__internalIsInitialized:!0},{stripExperimentalSettings,reset:!0})}),[settings,stripExperimentalSettings,__experimentalUpdateSettings]),(0,use_block_sync.A)(props);const children=(0,jsx_runtime.jsxs)(slot_fill.Kq,{passthrough:!0,children:[!settings?.isPreviewMode&&(0,jsx_runtime.jsx)(keyboard_shortcuts.Register,{}),(0,jsx_runtime.jsx)(block_refs_provider.z,{children:props.children})]});return window.__experimentalMediaProcessing?(0,jsx_runtime.jsx)(provider.A,{settings:mediaUploadSettings,useSubRegistry:!1,children}):children})),BlockEditorProvider=props=>(0,jsx_runtime.jsx)(ExperimentalBlockEditorProvider,{...props,stripExperimentalSettings:!0,children:props.children});ExperimentalBlockEditorProvider.__docgenInfo={description:"",methods:[],displayName:"ExperimentalBlockEditorProvider"},BlockEditorProvider.__docgenInfo={description:"",methods:[],displayName:"BlockEditorProvider"}},"./packages/block-editor/src/components/provider/use-block-sync.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>useBlockSync});var _wordpress_element__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/index.js"),_wordpress_data__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/data/build-module/components/registry-provider/use-registry.js"),_wordpress_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/data/build-module/components/use-select/index.js"),_wordpress_blocks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/blocks/build-module/index.js"),_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/block-editor/src/store/index.js");const noop=()=>{};function useBlockSync({clientId=null,value:controlledBlocks,selection:controlledSelection,onChange=noop,onInput=noop}){const registry=(0,_wordpress_data__WEBPACK_IMPORTED_MODULE_2__.A)(),{resetBlocks,resetSelection,replaceInnerBlocks,setHasControlledInnerBlocks,__unstableMarkNextChangeAsNotPersistent}=registry.dispatch(_store__WEBPACK_IMPORTED_MODULE_1__.M),{getBlockName,getBlocks,getSelectionStart,getSelectionEnd}=registry.select(_store__WEBPACK_IMPORTED_MODULE_1__.M),isControlled=(0,_wordpress_data__WEBPACK_IMPORTED_MODULE_3__.A)((select=>!clientId||select(_store__WEBPACK_IMPORTED_MODULE_1__.M).areInnerBlocksControlled(clientId)),[clientId]),pendingChangesRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)({incoming:null,outgoing:[]}),subscribedRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(!1),setControlledBlocks=()=>{controlledBlocks&&(__unstableMarkNextChangeAsNotPersistent(),clientId?registry.batch((()=>{setHasControlledInnerBlocks(clientId,!0);const storeBlocks=controlledBlocks.map((block=>(0,_wordpress_blocks__WEBPACK_IMPORTED_MODULE_0__.JB)(block)));subscribedRef.current&&(pendingChangesRef.current.incoming=storeBlocks),__unstableMarkNextChangeAsNotPersistent(),replaceInnerBlocks(clientId,storeBlocks)})):(subscribedRef.current&&(pendingChangesRef.current.incoming=controlledBlocks),resetBlocks(controlledBlocks)))},onInputRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(onInput),onChangeRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(onChange);(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{onInputRef.current=onInput,onChangeRef.current=onChange}),[onInput,onChange]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{pendingChangesRef.current.outgoing.includes(controlledBlocks)?pendingChangesRef.current.outgoing[pendingChangesRef.current.outgoing.length-1]===controlledBlocks&&(pendingChangesRef.current.outgoing=[]):getBlocks(clientId)!==controlledBlocks&&(pendingChangesRef.current.outgoing=[],setControlledBlocks(),controlledSelection&&resetSelection(controlledSelection.selectionStart,controlledSelection.selectionEnd,controlledSelection.initialPosition))}),[controlledBlocks,clientId]);const isMountedRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(!1);(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{isMountedRef.current?isControlled||(pendingChangesRef.current.outgoing=[],setControlledBlocks()):isMountedRef.current=!0}),[isControlled]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{const{getSelectedBlocksInitialCaretPosition,isLastBlockChangePersistent,__unstableIsLastBlockChangeIgnored,areInnerBlocksControlled}=registry.select(_store__WEBPACK_IMPORTED_MODULE_1__.M);let blocks=getBlocks(clientId),isPersistent=isLastBlockChangePersistent(),previousAreBlocksDifferent=!1;subscribedRef.current=!0;const unsubscribe=registry.subscribe((()=>{if(null!==clientId&&null===getBlockName(clientId))return;if(!(!clientId||areInnerBlocksControlled(clientId)))return;const newIsPersistent=isLastBlockChangePersistent(),newBlocks=getBlocks(clientId),areBlocksDifferent=newBlocks!==blocks;if(blocks=newBlocks,areBlocksDifferent&&(pendingChangesRef.current.incoming||__unstableIsLastBlockChangeIgnored()))return pendingChangesRef.current.incoming=null,void(isPersistent=newIsPersistent);if(areBlocksDifferent||previousAreBlocksDifferent&&!areBlocksDifferent&&newIsPersistent&&!isPersistent){isPersistent=newIsPersistent,pendingChangesRef.current.outgoing.push(blocks);(isPersistent?onChangeRef.current:onInputRef.current)(blocks,{selection:{selectionStart:getSelectionStart(),selectionEnd:getSelectionEnd(),initialPosition:getSelectedBlocksInitialCaretPosition()}})}previousAreBlocksDifferent=areBlocksDifferent}),_store__WEBPACK_IMPORTED_MODULE_1__.M);return()=>{subscribedRef.current=!1,unsubscribe()}}),[registry,clientId]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>()=>{__unstableMarkNextChangeAsNotPersistent(),clientId?(setHasControlledInnerBlocks(clientId,!1),__unstableMarkNextChangeAsNotPersistent(),replaceInnerBlocks(clientId,[])):resetBlocks([])}),[])}}}]);